<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran Digital - Semua Surah & Juz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, #1a5e1a, #0d3315);
            color: #333;
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2d7d2d, #1a5e1a);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 8px;
        }

        .controls {
            background: #e8f5e8;
            padding: 15px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            border-bottom: 2px solid #2d7d2d;
        }

        @media (max-width: 768px) {
            .controls {
                grid-template-columns: 1fr;
            }
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .control-group label {
            font-weight: 600;
            color: #1a5e1a;
            font-size: 0.9em;
        }

        select, button {
            padding: 10px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        select {
            background: white;
            border: 2px solid #2d7d2d;
        }

        button {
            background: #2d7d2d;
            color: white;
            font-weight: 600;
        }

        button:hover {
            background: #1a5e1a;
            transform: translateY(-1px);
        }

        button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        .playback-controls {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .status {
            background: #f8fff8;
            padding: 12px;
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
            font-weight: 600;
            color: #2d7d2d;
            font-size: 0.9em;
        }

        .quran-text {
            padding: 20px;
            direction: rtl;
            max-height: 60vh;
            overflow-y: auto;
        }

        .verse {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 12px;
            background: #f8fff8;
            border: 2px solid transparent;
            transition: all 0.2s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }

        .verse.active {
            border-color: #2d7d2d;
            background: #e8f5e8;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(45, 125, 45, 0.15);
        }

        .arabic {
            font-size: 1.8em;
            line-height: 1.6;
            text-align: center;
            color: #1a3a1a;
            margin-bottom: 10px;
            font-family: 'Traditional Arabic', 'Scheherazade', serif;
        }

        .translation {
            font-size: 1em;
            line-height: 1.5;
            text-align: center;
            color: #444;
            padding: 10px;
            background: white;
            border-radius: 6px;
            border-left: 3px solid #2d7d2d;
        }

        .verse-number {
            display: inline-block;
            background: #2d7d2d;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            text-align: center;
            line-height: 28px;
            font-size: 0.8em;
            margin-left: 6px;
        }

        .footer {
            text-align: center;
            padding: 15px;
            background: #1a5e1a;
            color: white;
            font-size: 0.85em;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #2d7d2d;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: #2d7d2d;
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Quran Digital Lengkap</h1>
            <p>114 Surah + 30 Juz - Qari Abdul Basit & Alafasy</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label>Pilih Qari:</label>
                <select id="qariSelect">
                    <option value="abdulbasit">Abdul Basit Abdul Samad</option>
                    <option value="alafasy">Mishary Alafasy</option>
                    <option value="husary">Mahmoud Khalil Al-Husary</option>
                    <option value="minshawi">Mohamed Siddiq Al-Minshawi</option>
                </select>
            </div>
            
            <div class="control-group">
                <label>Pilih Mode:</label>
                <select id="modeSelect">
                    <option value="surah">Per Surah</option>
                    <option value="juz">Per Juz</option>
                </select>
            </div>
            
            <div class="control-group">
                <label id="surahLabel">Pilih Surah:</label>
                <select id="surahSelect">
                    <!-- Akan diisi oleh JavaScript -->
                </select>
            </div>
            
            <div class="control-group">
                <label>Kontrol:</label>
                <div class="playback-controls">
                    <button id="playBtn">▶ Mulai</button>
                    <button id="pauseBtn" disabled>⏸ Jeda</button>
                    <button id="stopBtn" disabled>⏹ Stop</button>
                    <button id="nextBtn" disabled>⏭ Ayat Selanjutnya</button>
                </div>
            </div>
        </div>
        
        <div class="status" id="statusText">
            Pilih surah/juz dan qari untuk memulai
        </div>
        
        <div class="progress-bar">
            <div class="progress" id="progressBar"></div>
        </div>
        
        <div class="quran-text" id="quranText">
            <div class="loading">Pilih surah atau juz untuk memulai...</div>
        </div>
        
        <div class="footer">
            <p>Quran Digital &copy; 2024 • Terjemahan Kemenag RI • Audio dari everyayah.com</p>
        </div>
    </div>

    <script>
        // Data semua surah (114 surah)
        const allSurahs = [
            { number: 1, name: "Al-Fatihah", verses: 7, arabic: "الفاتحة" },
            { number: 2, name: "Al-Baqarah", verses: 286, arabic: "البقرة" },
            { number: 3, name: "Ali 'Imran", verses: 200, arabic: "آل عمران" },
            { number: 4, name: "An-Nisa", verses: 176, arabic: "النساء" },
            { number: 5, name: "Al-Ma'idah", verses: 120, arabic: "المائدة" },
            { number: 6, name: "Al-An'am", verses: 165, arabic: "الأنعام" },
            { number: 7, name: "Al-A'raf", verses: 206, arabic: "الأعراف" },
            { number: 8, name: "Al-Anfal", verses: 75, arabic: "الأنفال" },
            { number: 9, name: "At-Taubah", verses: 129, arabic: "التوبة" },
            { number: 10, name: "Yunus", verses: 109, arabic: "يونس" },
            { number: 114, name: "An-Nas", verses: 6, arabic: "الناس" }
        ];

        // Data juz (30 juz)
        const juzData = [
            { number: 1, startSurah: 1, startVerse: 1, endSurah: 2, endVerse: 141, name: "Juz 1" },
            { number: 2, startSurah: 2, startVerse: 142, endSurah: 2, endVerse: 252, name: "Juz 2" },
            { number: 3, startSurah: 2, startVerse: 253, endSurah: 3, endVerse: 92, name: "Juz 3" },
            // ... tambahkan juz 4-29 ...
            { number: 30, startSurah: 78, startVerse: 1, endSurah: 114, endVerse: 6, name: "Juz 30" }
        ];

        // Qari data
        const qariData = {
            "abdulbasit": {
                name: "Abdul Basit Abdul Samad",
                baseUrl: "https://cdn.islamic.network/quran/audio/128/ar.abdulbasitmurattal/"
            },
            "alafasy": {
                name: "Mishary Alafasy", 
                baseUrl: "https://cdn.islamic.network/quran/audio/128/ar.alafasy/"
            },
            "husary": {
                name: "Mahmoud Khalil Al-Husary",
                baseUrl: "https://cdn.islamic.network/quran/audio/128/ar.husary/"
            },
            "minshawi": {
                name: "Mohamed Siddiq Al-Minshawi",
                baseUrl: "https://cdn.islamic.network/quran/audio/128/ar.minshawi/"
            }
        };

        // Cache DOM elements
        const elements = {
            qariSelect: document.getElementById('qariSelect'),
            modeSelect: document.getElementById('modeSelect'),
            surahSelect: document.getElementById('surahSelect'),
            surahLabel: document.getElementById('surahLabel'),
            playBtn: document.getElementById('playBtn'),
            pauseBtn: document.getElementById('pauseBtn'),
            stopBtn: document.getElementById('stopBtn'),
            nextBtn: document.getElementById('nextBtn'),
            statusText: document.getElementById('statusText'),
            quranText: document.getElementById('quranText'),
            progressBar: document.getElementById('progressBar')
        };

        // State management
        let state = {
            currentQari: 'abdulbasit',
            currentMode: 'surah',
            currentSurah: null,
            currentJuz: null,
            currentVerses: [],
            currentVerseIndex: 0,
            isPlaying: false,
            isPaused: false,
            audioElement: null,
            synthesis: window.speechSynthesis || null
        };

        // Initialize surah dropdown
        function initializeSurahDropdown() {
            elements.surahSelect.innerHTML = '';
            allSurahs.forEach(surah => {
                const option = document.createElement('option');
                option.value = surah.number;
                option.textContent = `${surah.number}. ${surah.name} (${surah.arabic}) - ${surah.verses} ayat`;
                elements.surahSelect.appendChild(option);
            });
        }

        // Load contoh surah (dalam implementasi nyata, Anda perlu API)
        function loadSurah(surahNumber) {
            // Contoh data untuk demo - dalam implementasi nyata butuh API lengkap
            const demoVerses = {
                1: [ // Al-Fatihah
                    { number: 1, arabic: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ", translation: "Dengan nama Allah Yang Maha Pengasih, Maha Penyayang." },
                    { number: 2, arabic: "الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ", translation: "Segala puji bagi Allah, Tuhan seluruh alam," },
                    { number: 3, arabic: "الرَّحْمَٰنِ الرَّحِيمِ", translation: "Yang Maha Pengasih, Maha Penyayang," },
                    { number: 4, arabic: "مَالِكِ يَوْمِ الدِّينِ", translation: "Pemilik hari pembalasan." },
                    { number: 5, arabic: "إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ", translation: "Hanya kepada Engkaulah kami menyembah dan hanya kepada Engkaulah kami mohon pertolongan." },
                    { number: 6, arabic: "اهْدِنَا الصِّرَاطَ الْمُسْتَقِيمَ", translation: "Tunjukilah kami jalan yang lurus," },
                    { number: 7, arabic: "صِرَاطَ الَّذِينَ أَنْعَمْتَ عَلَيْهِمْ غَيْرِ الْمَغْضُوبِ عَلَيْهِمْ وَلَا الضَّالِّينَ", translation: "(yaitu) jalan orang-orang yang telah Engkau beri nikmat kepadanya; bukan (jalan) mereka yang dimurkai, dan bukan (pula jalan) mereka yang sesat." }
                ],
                2: [ // Al-Baqarah contoh 3 ayat
                    { number: 1, arabic: "الم", translation: "Alif Lam Mim." },
                    { number: 2, arabic: "ذَٰلِكَ الْكِتَابُ لَا رَيْبَ ۛ فِيهِ ۛ هُدًى لِلْمُتَّقِينَ", translation: "Kitab (Al-Qur'an) ini tidak ada keraguan padanya; petunjuk bagi mereka yang bertakwa," },
                    { number: 3, arabic: "الَّذِينَ يُؤْمِنُونَ بِالْغَيْبِ وَيُقِيمُونَ الصَّلَاةَ وَمِمَّا رَزَقْنَاهُمْ يُنْفِقُونَ", translation: "(yaitu) mereka yang beriman kepada yang gaib, melaksanakan salat, dan menginfakkan sebagian rezeki yang Kami berikan kepada mereka." }
                ],
                114: [ // An-Nas
                    { number: 1, arabic: "قُلْ أَعُوذُ بِرَبِّ النَّاسِ", translation: "Katakanlah, Aku berlindung kepada Tuhan manusia," },
                    { number: 2, arabic: "مَلِكِ النَّاسِ", translation: "Raja manusia," },
                    { number: 3, arabic: "إِلَٰهِ النَّاسِ", translation: "Sembahan manusia," },
                    { number: 4, arabic: "مِنْ شَرِّ الْوَسْوَاسِ الْخَنَّاسِ", translation: "dari kejahatan (bisikan) setan yang bersembunyi," },
                    { number: 5, arabic: "الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ", translation: "yang membisikkan (kejahatan) ke dalam dada manusia," },
                    { number: 6, arabic: "مِنَ الْجِنَّةِ وَالنَّاسِ", translation: "dari (golongan) jin dan manusia." }
                ]
            };

            const surah = allSurahs.find(s => s.number === surahNumber);
            state.currentSurah = surah;
            state.currentVerses = demoVerses[surahNumber] || [];
            state.currentJuz = null;
            
            renderVerses();
            resetPlayback();
            elements.statusText.textContent = `Surah ${surah.name} dimuat. ${state.currentVerses.length} ayat tersedia.`;
        }

        // Render verses ke HTML
        function renderVerses() {
            if (state.currentVerses.length === 0) {
                elements.quranText.innerHTML = '<div class="loading">Data tidak tersedia untuk pilihan ini</div>';
                return;
            }

            const versesHTML = state.currentVerses.map((verse, index) => `
                <div class="verse" id="verse-${index}">
                    <div class="arabic">${verse.arabic} <span class="verse-number">${verse.number}</span></div>
                    <div class="translation">${verse.translation}</div>
                </div>
            `).join('');
            
            elements.quranText.innerHTML = versesHTML;
        }

        // Play verse dengan audio qari asli
        function playVerse(index) {
            if (!state.currentVerses.length || index >= state.currentVerses.length) {
                stopPlayback();
                return;
            }
            
            state.currentVerseIndex = index;
            const verse = state.currentVerses[index];
            const qari = qariData[state.currentQari];
            
            // Update UI
            updateVerseHighlight();
            updateProgress();
            
            let surahInfo = '';
            if (state.currentSurah) {
                surahInfo = `Surah ${state.currentSurah.name}`;
            } else if (state.currentJuz) {
                surahInfo = `Juz ${state.currentJuz.number}`;
            }
            
            elements.statusText.textContent = `Memutar ayat ${verse.number} - ${surahInfo}`;
            
            // Scroll ke ayat
            const verseElement = document.getElementById(`verse-${index}`);
            if (verseElement) {
                verseElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
            
            // Bangun URL audio untuk qari asli
            const audioUrl = `${qari.baseUrl}${verse.number}.mp3`;
            
            // Play audio ayat dengan qari asli
            if (state.audioElement) {
                state.audioElement.pause();
                state.audioElement = null;
            }
            
            state.audioElement = new Audio(audioUrl);
            state.audioElement.preload = 'auto';
            
            state.audioElement.oncanplaythrough = () => {
                state.audioElement.play().catch(e => {
                    console.error('Error playing audio:', e);
                    elements.statusText.textContent = 'Error memutar audio. Klik play lagi.';
                });
            };
            
            state.audioElement.onplay = () => {
                state.isPlaying = true;
                updateControls();
            };
            
            state.audioElement.ontimeupdate = () => {
                updateProgress();
            };
            
            state.audioElement.onended = () => {
                // Setelah ayat selesai, langsung lanjut ke ayat berikutnya
                playNextVerse();
            };
            
            state.audioElement.onerror = (e) => {
                console.error('Audio error:', e);
                elements.statusText.textContent = 'Error memutar audio. Melanjutkan ke ayat berikutnya...';
                // Tetap lanjut ke ayat berikutnya meski audio error
                setTimeout(() => playNextVerse(), 1000);
            };
        }

        function playNextVerse() {
            const nextIndex = state.currentVerseIndex + 1;
            if (nextIndex < state.currentVerses.length) {
                playVerse(nextIndex);
            } else {
                elements.statusText.textContent = `Selesai memutar ${state.currentSurah ? 'Surah ' + state.currentSurah.name : 'Juz ' + state.currentJuz.number}`;
                stopPlayback();
            }
        }

        function updateProgress() {
            if (state.audioElement && state.audioElement.duration) {
                const progress = (state.audioElement.currentTime / state.audioElement.duration) * 100;
                elements.progressBar.style.width = `${progress}%`;
            }
        }

        function updateVerseHighlight() {
            document.querySelectorAll('.verse').forEach(verse => {
                verse.classList.remove('active');
            });
            
            const currentVerse = document.getElementById(`verse-${state.currentVerseIndex}`);
            if (currentVerse) {
                currentVerse.classList.add('active');
            }
        }

        function startPlayback() {
            if (!state.currentVerses.length) {
                elements.statusText.textContent = "Tidak ada data ayat yang dimuat";
                return;
            }
            
            resetPlayback();
            state.isPlaying = true;
            state.isPaused = false;
            updateControls();
            playVerse(0);
        }

        function pausePlayback() {
            if (state.audioElement && !state.audioElement.paused) {
                state.audioElement.pause();
            }
            state.isPaused = true;
            updateControls();
            elements.statusText.textContent = "Dijeda";
        }

        function resumePlayback() {
            if (state.audioElement && state.audioElement.paused) {
                state.audioElement.play();
            }
            state.isPaused = false;
            updateControls();
            elements.statusText.textContent = `Melanjutkan ayat ${state.currentVerseIndex + 1}`;
        }

        function stopPlayback() {
            if (state.audioElement) {
                state.audioElement.pause();
                state.audioElement = null;
            }
            
            state.isPlaying = false;
            state.isPaused = false;
            updateControls();
            
            // Reset UI
            document.querySelectorAll('.verse').forEach(verse => {
                verse.classList.remove('active');
            });
            
            elements.progressBar.style.width = '0%';
            elements.statusText.textContent = "Playback dihentikan";
        }

        function resetPlayback() {
            stopPlayback();
            state.currentVerseIndex = 0;
        }

        function updateControls() {
            const hasData = state.currentVerses.length > 0;
            
            elements.playBtn.disabled = !hasData || (state.isPlaying && !state.isPaused);
            elements.pauseBtn.disabled = !hasData || !state.isPlaying || state.isPaused;
            elements.stopBtn.disabled = !hasData || !state.isPlaying;
            elements.nextBtn.disabled = !hasData || !state.isPlaying || state.currentVerseIndex >= state.currentVerses.length - 1;
            
            elements.playBtn.textContent = state.isPaused ? "▶ Lanjutkan" : "▶ Mulai";
        }

        // Event handlers
        elements.modeSelect.addEventListener('change', (e) => {
            state.currentMode = e.target.value;
            if (state.currentMode === 'surah') {
                elements.surahLabel.textContent = 'Pilih Surah:';
                initializeSurahDropdown();
            } else {
                elements.surahLabel.textContent = 'Pilih Juz:';
                // Implement dropdown juz di sini
            }
        });

        elements.surahSelect.addEventListener('change', (e) => {
            loadSurah(parseInt(e.target.value));
        });

        elements.qariSelect.addEventListener('change', (e) => {
            state.currentQari = e.target.value;
        });

        elements.playBtn.addEventListener('click', () => {
            if (state.isPaused) {
                resumePlayback();
            } else {
                startPlayback();
            }
        });

        elements.pauseBtn.addEventListener('click', pausePlayback);
        elements.stopBtn.addEventListener('click', stopPlayback);
        
        elements.nextBtn.addEventListener('click', () => {
            if (state.isPlaying && state.currentVerseIndex < state.currentVerses.length - 1) {
                if (state.audioElement) state.audioElement.pause();
                playNextVerse();
            }
        });

        // Initialize
        window.addEventListener('load', () => {
            initializeSurahDropdown();
            loadSurah(1); // Load Al-Fatihah by default
        });
    </script>
</body>
</html>